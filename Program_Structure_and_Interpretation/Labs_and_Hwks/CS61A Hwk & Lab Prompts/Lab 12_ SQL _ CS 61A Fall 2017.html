<!DOCTYPE html>
<!-- saved from url=(0028)https://cs61a.org/lab/lab12/ -->
<html lang="en" class="gr__cs61a_org"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="description" content="CS 61A: Structure and Interpretation of Computer Programs">
    <meta name="keywords" content="CS 61A, Computer Science, CS, 61A, Programming, John DeNero, Berkeley, EECS">
    <meta name="author" content="John DeNero, Paul Hilfinger">
    
    <meta name="viewport" content="width=device-width">

    <script src="./Lab 12_ SQL _ CS 61A Fall 2017_files/jquery.min.js.download"></script>
    <script src="./Lab 12_ SQL _ CS 61A Fall 2017_files/bootstrap.min.js.download"></script>
    <script src="./Lab 12_ SQL _ CS 61A Fall 2017_files/highlight.min.js.download"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <link rel="stylesheet" href="./Lab 12_ SQL _ CS 61A Fall 2017_files/bootstrap.min.css">
    <link rel="stylesheet" href="./Lab 12_ SQL _ CS 61A Fall 2017_files/css">
    <link rel="stylesheet" href="./Lab 12_ SQL _ CS 61A Fall 2017_files/style.css">
    <link rel="stylesheet" href="./Lab 12_ SQL _ CS 61A Fall 2017_files/mono-blue.css">
    <link rel="icon" href="https://cs61a.org/assets/images/favicon.ico">

    

    <title>
Lab 12: SQL | CS 61A Fall 2017
</title>
  </head>

  <body id="index" class="home" data-gr-c-s-loaded="true">
    <nav class="navbar navbar-default navbar-static-top">
      <div class="container noselect">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse-section">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="https://cs61a.org/">CS 61A</a>
        </div>

        <div class="collapse navbar-collapse" id="navbar-collapse-section">
          <ul class="nav navbar-nav navbar-right">
            <li><a href="https://cs61a.org/weekly.html">Weekly Schedule</a></li>
            <li><a href="https://cs61a.org/office-hours.html">Office Hours</a></li>
            <li><a href="https://cs61a.org/staff.html">Staff</a></li>
            <li><a href="https://cs61a.org/resources.html">Resources</a></li>
            <li><a href="https://cs61a.org/articles/about.html">Policies</a></li>
            <li><a href="http://tutor.cs61a.org/">Tutor</a></li>
            <li><a href="https://piazza.com/berkeley/fall2017/cs61a" target="_blank">Piazza</a></li>
          </ul>
        </div>
      </div>
    </nav>

    <main id="content" class="container">
      
<div class="row">
  <div class="col-md-9">
    <header>
      <h1>
        
Lab 12: SQL

        
        <ul class="inline-block list-inline">
          <li><a href="https://cs61a.org/lab/lab12/lab12.zip" class="label label-outline">lab12.zip</a></li>
        </ul>
        
      </h1>
    </header>
    

<p><i>Due at 11:59pm on Friday, 11/17/2017.</i></p>


<h2 id="starter-files">Starter Files</h2>


<p>Download <a href="https://cs61a.org/lab/lab12/lab12.zip">lab12.zip</a>.
Inside the archive, you will find starter files for the questions in this lab,
  along with a copy of the <a href="https://cs61a.org/lab/lab12/ok">Ok</a> autograder.</p>


<h2 id="submission">Submission</h2>

<p>By the end of this lab, you should have submitted the lab with
<code>python3 ok --submit</code>. You may submit more than once before the
deadline; only the final submission will be graded.
Check that you have successfully submitted your code on
<a href="https://okpy.org/">okpy.org</a>.</p>

<ul>
  <li>To receive credit for this lab, you must complete Questions 2-6 in <a href="https://cs61a.org/lab/lab12/lab12.sql">lab12.sql</a>, and submit through OK.</li>
  <li>Question 7 and 8 are considered <strong>extra practice</strong>.
  They can be found in the <a href="https://cs61a.org/lab/lab12/lab12_extra.sql">lab12_extra.sql</a> file. It is
  recommended that you complete them on your own time.</li>
</ul>



    
<h2 id="setup">Setup</h2>


<p>The simplest way to start using SQLite is to download a precompiled
binary from the <a href="http://www.sqlite.org/download.html">SQLite website</a>.
The latest version of SQLite at the time of writing is 3.20.0, but you
can check for additional updates on the website.</p>


<h3 id="windows">Windows</h3>


<ol>
  <li>Visit the download page linked above and navigate to the section
  Precompiled Binaries for Windows. Click on the link
  <strong>sqlite-tools-win32-x86-*.zip</strong> to download the binary.</li>
  <li>Unzip the file. There should be a <code>sqlite3.exe</code> file in the
  directory after extraction.</li>
  <li><p>Navigate to the folder containing the <code>sqlite3.exe</code> file and check
  that the version is at least 3.8.3:</p>

<pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"> <span class="hljs-built_in">cd</span> path/to/sqlite</span>
<span class="hljs-meta">$</span><span class="bash"> ./sqlite3 --version</span>
3.12.1 2016-04-08 15:09:49 fe7d3b75fe1bde41511b323925af8ae1b910bc4d</code></pre></li>
</ol>


<h3 id="macos-yosemite-10-10-el-capitan-10-11-sierra-10-12">macOS Yosemite (10.10), El Capitan (10.11), Sierra (10.12)</h3>


<p>SQLite comes pre-installed. Check that you have a version that's greater than 3.8.3:</p>

<pre><code class="hljs ruby">    $ sqlite3
    SQLite version <span class="hljs-number">3.8</span>.<span class="hljs-number">10.2</span></code></pre>


<h3 id="mac-os-x-mavericks-10-9-or-older">Mac OS X Mavericks (10.9) or older</h3>


<p>SQLite comes pre-installed, but it is the wrong version.</p>

<ol>
  <li>Visit the download page linked above and navigate to the section
  <strong>Precompiled Binaries for Mac OS X (x86)</strong>. Click on
  the link <strong>sqlite-tools-osx-x86-*.zip</strong> to download the
  binary.</li>
  <li>Unzip the file. There should be a <code>sqlite3</code> file in the directory
  after extraction.</li>
  <li><p>Navigate to the folder containing the <code>sqlite3</code> file and check that
  the version is at least 3.8.3:</p>

<pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"> <span class="hljs-built_in">cd</span> path/to/sqlite</span>
<span class="hljs-meta">$</span><span class="bash"> ./sqlite3 --version</span>
3.12.1 2016-04-08 15:09:49 fe7d3b75fe1bde41511b323925af8ae1b910bc4d</code></pre></li>
</ol>


<h3 id="ubuntu">Ubuntu</h3>


<p>The easiest way to use SQLite on Ubuntu is to install it straight from
the native repositories (the version will be slightly behind the most
recent release):</p>

<pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"> sudo apt-get install sqlite3</span>
<span class="hljs-meta">$</span><span class="bash"> sqlite3 --version</span>
3.8.6 2014-08-15 11:46:33 9491ba7d738528f168657adb43a198238abde19e</code></pre>


<h2 id="usage">Usage</h2>


<blockquote><p><em>Note:</em> If you downloaded a precompiled binary above, make sure that
<code>sqlite3.exe</code> file is in the same directory as your
<code>.sql</code> file. (Extract and move it out from the zip file you
  downloaded.)</p></blockquote>

<p>After writing your code in the <code>.sql</code> file, you can test and verify
your output in Terminal or Git Bash with one of the two following
commands.</p>

<p>1.) Runs your code and then exits SQLite immediately afterwards.</p>

<ul>
  <li><p>Ubuntu / Mac OS X (Yosemite or newer)</p>

<pre><code class="hljs css"><span class="hljs-selector-tag">sqlite3</span> &lt; <span class="hljs-selector-tag">lab12</span><span class="hljs-selector-class">.sql</span></code></pre></li>
  <li><p>Windows / Mac OS X (Mavericks or older)</p>

<pre><code class="hljs">./sqlite3 &lt; lab12.sql</code></pre></li>
</ul>

<p>2.) Runs your code and keeps SQLite open for further commands, which
is similar to running Python code with the interactive <code>-i</code> flag.
You can type <code>.help</code> to see some of the commands you can run.</p>

<ul>
  <li><p>Ubuntu / Mac OS X (Yosemite or newer)</p>

<pre><code class="hljs css"><span class="hljs-selector-tag">sqlite3</span> <span class="hljs-selector-tag">--init</span> <span class="hljs-selector-tag">lab12</span><span class="hljs-selector-class">.sql</span></code></pre></li>
  <li><p>Windows / Mac OS X (Mavericks or older)</p>

<pre><code class="hljs sql">./sqlite3 <span class="hljs-comment">--init lab12.sql</span></code></pre></li>
</ul>

<p>To exit out of SQLite after using the second command, type <code>.exit</code> or <code>.quit</code> or you can hit
<code>Ctrl-C</code>. Also if you see <code>...&gt;</code> you probably forgot a <code>;</code></p>

<h2 id="sql-basics">SQL Basics</h2>



<h3 id="creating-tables">Creating Tables</h3>


<p>You can create SQL tables either from scratch or from existing tables.</p>

<p>Below creates the table from scratch, without referencing any
other existing tables.</p>

<pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> [table_name] <span class="hljs-keyword">AS</span>
  <span class="hljs-keyword">SELECT</span> [val1] <span class="hljs-keyword">AS</span> [column1], [val2] <span class="hljs-keyword">AS</span> [column2], ... <span class="hljs-keyword">UNION</span>
  <span class="hljs-keyword">SELECT</span> [val3]             , [val4]             , ... <span class="hljs-keyword">UNION</span>
  <span class="hljs-keyword">SELECT</span> [val5]             , [val6]             , ...;</code></pre>

<blockquote><p><em>Note:</em> You do not need to repeat the <code>AS</code> keyword in subsequent
SELECT statements when creating the table.</p></blockquote>

<p>Here is an example where we construct a table with the <code>CREATE TABLE</code>
statement. <code>UNION</code> is used here to join rows and <code>AS</code> assigns a table column to a new name.</p>

<pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> Football <span class="hljs-keyword">AS</span>
  <span class="hljs-keyword">SELECT</span> <span class="hljs-number">30</span> <span class="hljs-keyword">AS</span> Berkeley, <span class="hljs-number">7</span> <span class="hljs-keyword">AS</span> Stanford, <span class="hljs-number">2002</span> <span class="hljs-keyword">AS</span> <span class="hljs-keyword">Year</span> <span class="hljs-keyword">UNION</span>
  <span class="hljs-keyword">SELECT</span> <span class="hljs-number">28</span>,             <span class="hljs-number">16</span>,            <span class="hljs-number">2003</span>         <span class="hljs-keyword">UNION</span>
  <span class="hljs-keyword">SELECT</span> <span class="hljs-number">17</span>,             <span class="hljs-number">38</span>,            <span class="hljs-number">2014</span>;</code></pre>

<p><img class="img-responsive center-block" src="./Lab 12_ SQL _ CS 61A Fall 2017_files/football.png" alt="football"></p>

<p>Here we have created a table called <code>Football</code>, which has three attributes
(columns): <code>Berkeley</code>, <code>Stanford</code>, and <code>Year</code>. We can later access the
values from this table by referencing the table's columns.</p>

<p>To create tables from existing tables, the <code>SELECT</code> command references
another table.</p>


<h3 id="selecting-from-tables">Selecting From Tables</h3>

<p>More commonly, we will create new tables by selecting specific columns
that we want from existing tables. <code>SELECT</code> statements can include optional
clauses such as:</p>

<ul>
  <li><code>FROM</code>: tells SQL which tables to select values from</li>
  <li><code>WHERE</code>: filters by some condition</li>
  <li><code>ORDER BY</code>: enforces an ordering by some attribute or attributes (usually a column or columns)</li>
  <li><p><code>LIMIT</code>: limits the number of rows in the output table</p>

<pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> [<span class="hljs-keyword">columns</span>] <span class="hljs-keyword">FROM</span> [<span class="hljs-keyword">tables</span>] <span class="hljs-keyword">WHERE</span> [condition] <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> [<span class="hljs-keyword">attributes</span>] <span class="hljs-keyword">LIMIT</span> [<span class="hljs-keyword">limit</span>];</code></pre></li>
</ul>

<p>Notes about the arguments:</p>

<ul>
  <li><code>[columns]</code>: a comma separated list of the columns to select, <code>*</code> can
  be used to select all of them</li>
  <li><code>[tables]</code>: a comma separated list of tables to select values from</li>
  <li><code>[condition]</code>: a Boolean expression</li>
  <li><code>[attributes]</code>: a comma separated list of attributes, which are usually
  columns, but could also be named aggregates (which we will learn later)</li>
  <li><code>[limit]</code>: an integer</li>
</ul>

<p>We can select all the values of an attribute from a table with the <code>SELECT</code>
statement. In addition, we can apply a filter using the <code>WHERE</code> clause. Here,
we filter by <code>Year &gt; 2002</code>, which makes the <code>SELECT</code> statement keep only the
rows in the table whose <code>Year</code> value is greater than 2002.</p>

<pre><code class="hljs shell"><span class="hljs-meta">sqlite&gt;</span><span class="bash"> SELECT Berkeley FROM Football WHERE Year &gt; 2002;</span>
17
28</code></pre>

<p>Here we selected Berkeley's score for all years after 2002.</p>


<h3 id="expressions-in-sql">Expressions in SQL</h3>

<p>Here are some fundamental operations you can perform:</p>

<ul>
  <li>comparisons: <code>=</code>, <code>&gt;</code>, <code>&lt;</code>, <code>&lt;=</code>, <code>&gt;=</code>, <code>&lt;&gt;</code> ("not equal")</li>
  <li>booleans: <code>AND</code>, <code>OR</code></li>
  <li>arithmetic: <code>+</code>, <code>-</code>, <code>*</code>, <code>/</code></li>
</ul>

<p>We can also perform string concatenation using <code>||</code>, which behaves
similarly to <code>+</code> on strings in Python.</p>

<pre><code class="hljs ruby">sqlite&gt; SELECT <span class="hljs-string">"hello"</span> <span class="hljs-params">||</span> <span class="hljs-string">" "</span> <span class="hljs-params">||</span> <span class="hljs-string">"world"</span>;
hello world</code></pre>

<p>Note we capitalize SQL syntax purely for style. It makes it much easier to read,
though will work if you don't capitalize it.</p>


<h2 id="getting-to-know-your-fellow-61a-students">Getting to Know Your Fellow 61A Students</h2>


<p>In the past week, we asked you and your fellow students to complete a brief
online survey through Google Forms, which involved relatively random but fun
questions. In this lab, we will interact with the results of the survey by
using SQL queries to see if we can find interesting things in the data.</p>

<p>First, take a look at <code>fa17data.sql</code> and examine the table defined in it. Note
its structure. You will be working with:</p>

<ul>
  <li><p><code>students</code>: The main results of the survey. Each column represents a different
  question from the survey, except for the first column, which is the time
  of when the result was submitted. This time is a unique identifier for
  each of the rows in the table.</p>


  
        <div class="table-responsive">
          <table class="table table-bordered">
          
    <tbody><tr>
      <th>Column Name</th>
      <th>Question</th>
    </tr>
    <tr>
      <td><code>time</code></td>
      <td>The unique timestamp that identifies the submission</td>
    </tr>
    <tr>
      <td><code>number</code></td>
      <td>What's your favorite number between 1 and 100?</td>
    </tr>
    <tr>
      <td><code>color</code></td>
      <td>What is your favorite color?</td>
    </tr>
    <tr>
      <td><code>seven</code></td>
      <td>Choose the number 7 below.<br>Options: <br><ul> <li>7</li> <li>You are not the boss of me!</li> <li>I do what I want.</li> <li>I'm a rebel</li> <li>Choose this option instead.</li> <li>YOLO!</li> </ul></td>
    </tr>
    <tr>
      <td><code>song</code></td>
      <td>If you could listen to only one of these songs for the rest of your life, which would it be? <br> Options: <br><ul><li>"Despacito" by Luis Fonsi</li><li>"Havana" by Camila Cabello</li><li>"Nyan Cat"</li><li>"Look What You Made Me Do" by Taylor Swift</li><li>"All I Want for Christmas is You" by Mariah Carey</li><li>"Summer" by Marshmello</li><li>"Feels" by Calvin Harris</li></ul></td>
    </tr>
    <tr>
      <td><code>date</code></td>
      <td>Pick a day of the year!</td>
    </tr>
    <tr>
      <td><code>pet</code></td>
      <td>If you could have any animal in the world as a pet, what would it be?</td>
    </tr>
    <tr>
      <td><code>denero</code></td>
      <td>Choose your favorite photo of John DeNero! (Options shown under Question 2)</td>
    </tr>
    <tr>
      <td><code>hilfinger</code></td>
      <td>Choose your favorite phote of Paul Hilfinger! (Options shown under Question 2)</td>
    </tr>
    <tr>
      <td><code>smallest</code></td>
      <td>Try to guess the smallest unique positive INTEGER that anyone will put!</td>
    </tr>
  
          </tbody></table>
        </div>
        </li>
  <li><code>checkboxes</code>: The results from the survey in which students could select more
  than one option from the numbers listed, which ranged from 0 to 10 and included
  2017, 9000, and 9001. Each row has a time (which is again a unique
  identifier) and has the value <code>'True'</code> if the student selected the column or <code>'False'</code>
  if the student did not.
  The column names in this table are the following strings, referring to each possible
  number: <code>'0'</code>, <code>'1'</code>, <code>'2'</code>, <code>'4'</code>, <code>'5'</code>, <code>'6'</code>, <code>'7'</code>, <code>'8'</code>, <code>'9'</code>, <code>'10'</code>,
  <code>'2017'</code>, <code>'9000'</code>, <code>'9001'</code>.</li>
</ul>

<p>A time in <code>students</code> matches up with a time in <code>checkboxes</code>. For
example, the row with time "11/7/2017 20:27:44" in <code>students</code> matches up with
the row with time "11/7/2017 20:27:44" in <code>checkboxes</code>. These entries come from
the same Google form submission and thus belong to the same student. We used
time to uniquely identify each student, rather than using their name or email.</p>

<br>

<blockquote><p><em>Note</em>: If you are looking for your personal response within the data, you may
have noticed that some of your answers are slightly different from what you
inputted. In order to make SQLite accept our data, and to optimize for as
many matches as possible during our joins, we did the following things to
clean up the data:</p>

<ul>
  <li><code>color</code> and <code>pet</code>: We converted all the strings to be completely lowercase.</li>
  <li>For some of the more "free-spirited" responses, we escaped the special
  characters so that they could be properly parsed.</li>
</ul></blockquote>

<p>You will write all of your solutions in the starter file <code>lab12.sql</code> provided. As with other
labs, you can test your solutions with OK. In addition, you can use either of
the following commands. You may need to refer to the Usage section to find the
appropriate command for your OS:</p>

<pre><code class="hljs css"><span class="hljs-selector-tag">sqlite3</span> &lt; <span class="hljs-selector-tag">lab12</span><span class="hljs-selector-class">.sql</span>
<span class="hljs-selector-tag">sqlite3</span> <span class="hljs-selector-tag">--init</span> <span class="hljs-selector-tag">lab12</span><span class="hljs-selector-class">.sql</span></code></pre>

<h3 class="question" id="q1">Q1: What Would SQL print?</h3>

<p>First, load the tables into sqlite3. If you're on Windows or Mac OS X
(Mavericks or older), use the following command:</p>

<pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"> ./sqlite3 --init lab12.sql</span></code></pre>

<p>If you're on Ubuntu or Mac OS X (Yosemite or newer), use:</p>

<pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"> sqlite3 --init lab12.sql</span></code></pre>

<p>Before we start, inspect the schema of the tables that we've created for you:</p>

<pre><code class="hljs shell"><span class="hljs-meta">sqlite&gt;</span><span class="bash"> .schema</span></code></pre>

<p>This tells you the name of each of our tables and their attributes.</p>

<p>Let's also take a look at some of the entries in our table. There are a lot of
entries though, so let's just output the first 20:</p>

<pre><code class="hljs shell"><span class="hljs-meta">sqlite&gt;</span><span class="bash"> SELECT * FROM students LIMIT 20;</span></code></pre>

<p>If you're curious about some of the answers students put into the Google form,
open up <code>fa17data.sql</code> in your favorite text editor and take a look!</p>

<p>For each of the SQL queries below, think about what the
query is looking for, then try running the query yourself and see!</p>

<pre><code class="hljs coffeescript">sqlite&gt; SELECT * FROM students; -- This <span class="hljs-keyword">is</span> a comment. * <span class="hljs-keyword">is</span> shorthand <span class="hljs-keyword">for</span> all columns!
<div class="alt prompt-1">______</div><div class="solution prompt-1">selects all records <span class="hljs-keyword">from</span> students;</div>
sqlite&gt; SELECT color FROM students WHERE number = <span class="hljs-number">16</span>;
<div class="alt prompt-1">______</div><div class="solution prompt-1">selects the color <span class="hljs-keyword">from</span> students who said their favorite number was <span class="hljs-number">16</span>;</div>
sqlite&gt; SELECT song, pet FROM students WHERE color = <span class="hljs-string">"blue"</span> AND date = <span class="hljs-string">"12/25"</span>;
<div class="alt prompt-1">______</div><div class="solution prompt-1">selects the song <span class="hljs-keyword">and</span> pet <span class="hljs-keyword">from</span> students who said their favorite color was blue <span class="hljs-keyword">and</span> picked December <span class="hljs-number">25</span>th;</div></code></pre>
        <button id="prompt-1" class="btn btn-outline btn-lg toggle prompt" style="display: inline-block;">
        Toggle Solution<noscript> (enable JavaScript)</noscript>
        </button>
        

<p>Remember, to exit out of SQLite after using the second command, type <code>.exit</code> or <code>.quit</code> or hit
<code>Ctrl-C</code>. Also, if you see <code>...&gt;</code> you probably forgot a <code>;</code>
</p><h3 class="question" id="q2">Q2: Obedience</h3><p></p>

<p>To warm-up, let's ask a simple question related to our data: Is there a
correlation between whether students do as they're told and their
favorite images of the instructors?</p>

<p><img class="img-responsive center-block" src="./Lab 12_ SQL _ CS 61A Fall 2017_files/denero.png" alt="denero">
<img class="img-responsive center-block" src="./Lab 12_ SQL _ CS 61A Fall 2017_files/hilfinger.png" alt="hilfinger"></p>

<p>Write a SQL query to create a table that contains the columns <code>seven</code> (this
column representing "obedience"), <code>denero</code> (the image of Professor DeNero students selected),
  and <code>hilfinger</code> (the image of Professor Hilfinger students selected)
from the <code>students</code> table.</p>

<p>You should get the following output:</p>

<pre><code class="hljs ruby">sqlite&gt; SELECT * FROM obedience LIMIT <span class="hljs-number">10</span>;
You are <span class="hljs-keyword">not</span> the boss of me!<span class="hljs-params">|Image 4|</span>Image <span class="hljs-number">3</span>
<span class="hljs-number">7</span><span class="hljs-params">|Image 3|</span>Image <span class="hljs-number">1</span>
<span class="hljs-number">7</span><span class="hljs-params">|Image 5|</span>Image <span class="hljs-number">4</span>
I <span class="hljs-keyword">do</span> what I want.<span class="hljs-params">|Image 1|</span>Image <span class="hljs-number">5</span>
You are <span class="hljs-keyword">not</span> the boss of me!<span class="hljs-params">|Image 2|</span>Image <span class="hljs-number">5</span>
Choose this option instead.<span class="hljs-params">|Image 2|</span>Image <span class="hljs-number">4</span>
I<span class="hljs-string">'m a rebel|Image 2|Image 1
Choose this option instead.|Image 4|Image 5
Choose this option instead.|Image 2|Image 1
Choose this option instead.|Image 2|Image 3</span></code></pre>



<pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> obedience <span class="hljs-keyword">AS</span>
<div class="alt solution-1">  <span class="hljs-keyword">SELECT</span> <span class="hljs-string">"REPLACE THIS LINE WITH YOUR SOLUTION"</span>;
</div><div class="solution solution-1">  <span class="hljs-keyword">SELECT</span> seven, denero, hilfinger <span class="hljs-keyword">FROM</span> students;</div></code></pre>


        <button id="solution-1" class="btn btn-outline btn-lg toggle solution" style="display: inline-block;">
        Toggle Solution<noscript> (enable JavaScript)</noscript>
        </button>
        

<p>Use Ok to test your code:</p><pre><code class="nohighlight">python3 ok -q obedience</code></pre>
<h3 class="question" id="q3">Q3: The Smallest Unique Positive Integer</h3>

<p>Who successfully managed to guess the smallest unique positive integer value? Let's find
out!</p>

<p>Unfortunately we have not learned how to do aggregations, which can help us count
the number of times a specific value was selected, in SQL just yet. As such, we
can only hand inspect our data to determine it. However, an anonymous elf has
informed us that the smallest unique positive value is greater than 18!</p>

<p>Write a SQL query with the columns <code>time</code> and <code>smallest</code> to try to determine what
the smallest integer value is. In order to make it easier for us to inspect these
values, use <code>WHERE</code> to restrict the answers to numbers greater than 18, <code>ORDER BY</code> to sort the numerical values, and <code>LIMIT</code> your result to the first 20 values that are greater than the number 18.</p>

<p>The first 5 lines of your output should look like this:</p>

<pre><code class="hljs ruby">sqlite&gt; SELECT * FROM smallest_int LIMIT <span class="hljs-number">5</span>;
<span class="hljs-number">11</span>/<span class="hljs-number">7</span>/<span class="hljs-number">2017</span> <span class="hljs-number">20</span><span class="hljs-symbol">:</span><span class="hljs-number">27</span><span class="hljs-symbol">:</span><span class="hljs-number">19</span><span class="hljs-params">|19
11/7/2017 20:28:25|</span><span class="hljs-number">19</span>
<span class="hljs-number">11</span>/<span class="hljs-number">7</span>/<span class="hljs-number">2017</span> <span class="hljs-number">20</span><span class="hljs-symbol">:</span><span class="hljs-number">45</span><span class="hljs-symbol">:</span>09<span class="hljs-params">|19
11/7/2017 20:54:01|</span><span class="hljs-number">19</span>
<span class="hljs-number">11</span>/<span class="hljs-number">7</span>/<span class="hljs-number">2017</span> <span class="hljs-number">20</span><span class="hljs-symbol">:</span><span class="hljs-number">57</span><span class="hljs-symbol">:</span>09<span class="hljs-params">|19</span></code></pre>



<pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> smallest_int <span class="hljs-keyword">AS</span>
<div class="alt solution-2">  <span class="hljs-keyword">SELECT</span> <span class="hljs-string">"REPLACE THIS LINE WITH YOUR SOLUTION"</span>;
</div><div class="solution solution-2">  <span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">time</span>, smallest <span class="hljs-keyword">FROM</span> students <span class="hljs-keyword">WHERE</span> smallest &gt; <span class="hljs-number">18</span> <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> smallest <span class="hljs-keyword">LIMIT</span> <span class="hljs-number">20</span>;</div></code></pre>


        <button id="solution-2" class="btn btn-outline btn-lg toggle solution" style="display: inline-block;">
        Toggle Solution<noscript> (enable JavaScript)</noscript>
        </button>
        

<p>Use Ok to test your code:</p><pre><code class="nohighlight">python3 ok -q smallest-int</code></pre>

<p>After you've successfully passed the Ok test, actually take a look at the table
<code>smallest_int</code> that you just created and find the smallest unique integer value! If you're curious how to do this with aggregations, check the <code>Extra Question</code>.</p>

<p>To do this, try the following:</p>

<pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"> sqlite3 --init lab12.sql</span>
<span class="hljs-meta">sqlite&gt;</span><span class="bash"> SELECT * FROM smallest_int; -- No LIMIT this time!</span></code></pre>


<h2 id="joins">Joins</h2>


<p>We can use <em>joins</em> to include rows from another table that satisfy the <code>WHERE</code>
predicate. Joins can either be on different tables, or the same table if we
include an alias. Here we are referencing the football table twice, using <code>AS</code> to bind the football table once as the alias <code>a</code> and once as the alias <code>b</code>.</p>

<pre><code class="hljs ruby">sqlite&gt; SELECT b.Berkeley - a.Berkeley, b.Stanford - a.Stanford, a.Year, b.Year
...&gt;        FROM Football AS a, Football AS b WHERE a.Year &lt; b.Year;
-<span class="hljs-number">11</span><span class="hljs-params">|22|</span><span class="hljs-number">2003</span><span class="hljs-params">|2014
-13|</span><span class="hljs-number">21</span><span class="hljs-params">|2002|</span><span class="hljs-number">2014</span>
-<span class="hljs-number">2</span><span class="hljs-params">|9|</span><span class="hljs-number">2002</span><span class="hljs-params">|2003</span></code></pre>

<p>What is this query asking for?</p>

<p>You may notice that it does not seem like we actually performed any operations
to do the join. However, the join is implicit in the fact that we listed more
than one table after the FROM. In this example, we joined the table <code>Football</code>
with itself and gave each instance of the table an alias, <code>a</code> and <code>b</code> so that
we could distinctly refer to each table's attributes and perform selections and
comparisons on them, such as <code>a.Year &lt; b.Year</code>.</p>

<p>One way to think of a join is that it produces a cross-product between the two
tables by matching each row from the first table with every other row in the
second table, which creates a new, larger joined table.</p>

<p>Here's an illustration of what happened in the joining process during the
above query.</p>

<p><img class="img-responsive center-block" src="./Lab 12_ SQL _ CS 61A Fall 2017_files/joins.png" alt="joins"></p>

<p>From here, the select statement examines the joined table and selects the values
it desires: <code>b.Berkeley - a.Berkeley</code> and <code>b.Stanford - a.Stanford</code> but only
from the rows <code>WHERE a.Year &lt; b.Year</code>. This prevents duplicate results from
appearing in our output and also removes rows where the years are the same.
</p><h3 class="question" id="q4">Q4: Great Students Think Alike</h3><p></p>

<p>We administered a similar survey for Lab 13 last semester to 61A students (see the table <code>sp17students</code>
in <code>sp17data.sql</code>). The only question that has been added is <code>denero</code>, so let's play around with this data using joins!</p>

<p>Great students think alike. We want to print out the information of students that have the same favorite
<code>date</code>, <code>color</code> and <code>pet</code>! How do their favorite <code>number</code>s differ?</p>

<blockquote><p><em>Hint:</em> When joining table names where column names are the same, use dot
notation to distinguish which columns are from which table. The structure is
<code>[table_name].[column name]</code>. This sometimes may get verbose, so itâ€™s
stylistically better to give tables an alias using the <code>AS</code> keyword.
The structure is: <code>SELECT &lt;[alias1].[column name1], [alias2].[columnname2]...&gt;
FROM &lt;[table_name1] AS [alias1],[table_name2] AS [alias2]...&gt; ...</code></p>

<p>The query in the football example from earlier uses this syntax.</p></blockquote>

<p>Write a SQL query to create a table that has 5 columns:</p>

<ul>
  <li>The shared favorite <code>date</code> between semesters</li>
  <li>The shared favorite <code>color</code> between semesters</li>
  <li>The shared favorite <code>pet</code> between semesters</li>
  <li>The favorite <code>number</code> of this semester's student</li>
  <li>The favorite <code>number</code> of last semester's student</li>
</ul>

<p>You should get the following output:</p>

<pre><code class="hljs ruby">sqlite&gt; SELECT * FROM greatstudents;
<span class="hljs-number">1</span>/<span class="hljs-number">1</span><span class="hljs-params">|black|</span>dragon<span class="hljs-params">|8|</span><span class="hljs-number">46</span>
<span class="hljs-number">1</span>/<span class="hljs-number">1</span><span class="hljs-params">|blue|</span>dog<span class="hljs-params">|60|</span><span class="hljs-number">69</span>
<span class="hljs-number">7</span>/<span class="hljs-number">7</span><span class="hljs-params">|7|</span><span class="hljs-number">7</span><span class="hljs-params">|7|</span><span class="hljs-number">7</span>
<span class="hljs-number">7</span>/<span class="hljs-number">7</span><span class="hljs-params">|7|</span><span class="hljs-number">7</span><span class="hljs-params">|7|</span><span class="hljs-number">7</span>
<span class="hljs-number">7</span>/<span class="hljs-number">7</span><span class="hljs-params">|7|</span><span class="hljs-number">7</span><span class="hljs-params">|7|</span><span class="hljs-number">7</span>
<span class="hljs-number">12</span>/<span class="hljs-number">31</span><span class="hljs-params">|blue|</span>dog<span class="hljs-params">|50|</span><span class="hljs-number">50</span>
<span class="hljs-number">12</span>/<span class="hljs-number">16</span><span class="hljs-params">|blue|</span>dog<span class="hljs-params">|7|</span><span class="hljs-number">42</span></code></pre>



<pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> greatstudents <span class="hljs-keyword">AS</span>
<div class="alt solution-3">  <span class="hljs-keyword">SELECT</span> <span class="hljs-string">"REPLACE THIS LINE WITH YOUR SOLUTION"</span>;
</div><div class="solution solution-3">  <span class="hljs-keyword">SELECT</span> a.date, a.color, a.pet, a.number, b.number <span class="hljs-keyword">FROM</span> students <span class="hljs-keyword">AS</span> a, sp17students <span class="hljs-keyword">AS</span> b
    <span class="hljs-keyword">WHERE</span> a.date = b.date <span class="hljs-keyword">AND</span> a.color = b.color <span class="hljs-keyword">AND</span> a.pet = b.pet;</div></code></pre>


        <button id="solution-3" class="btn btn-outline btn-lg toggle solution" style="display: inline-block;">
        Toggle Solution<noscript> (enable JavaScript)</noscript>
        </button>
        

<p>Use Ok to test your code:</p><pre><code class="nohighlight">python3 ok -q greatstudents</code></pre>

<p>After you've successfully passed the Ok test, play around some more with joins to see what cool connections
you can draw between the data from both semesters!
</p><h3 class="question" id="q5">Q5: Sevens</h3><p></p>

<p>Let's take a look at data from both of our tables, <code>students</code> and <code>checkboxes</code>,
to find out if students that really like the number 7 also chose <code>'7'</code> for the
obedience question. Specifically, we want to look at the students that fulfill
the below conditions and see if they also chose <code>'7'</code> in the question that asked
students to choose the number 7 (column <code>seven</code> in <code>students</code>).</p>

<p>Conditions:</p>

<ul>
  <li>reported that their favorite number (column <code>number</code> in <code>students</code>) was 7</li>
  <li>have <code>'True'</code> in column <code>'7'</code> in <code>checkboxes</code>, meaning they checked the number <code>7</code> during the survey</li>
</ul>

<p>In order to examine rows from both the <code>students</code> and the <code>checkboxes</code> table, we will
need to perform a join.</p>

<p>How would you specify the <code>WHERE</code> clause to make the <code>SELECT</code> statement only consider
rows in the joined table whose values all correspond to the same student? If
you find that your output is massive and overwhelming, then you are probably missing
the necessary condition in your <code>WHERE</code> clause to ensure this.</p>

<blockquote><p><em>Note:</em> The columns in the <code>checkboxes</code> table are strings with the associated number,
so you must put quotes around the column name to refer to it. For example if you alias
the table as <code>a</code>, to get the column to see if a student checked 9001, you must write
<code>a.'9001'</code>.</p></blockquote>

<p>Write a SQL query to create a table with just the column <code>seven</code> from <code>students</code>, filtering
first for students who said their favorite number (column <code>number</code>) was 7 in the <code>students</code>
table and who checked the box for seven (column <code>'7'</code>) in the <code>checkboxes</code> table.</p>

<p>You should get the following output:</p>

<pre><code class="hljs coffeescript">sqlite&gt; SELECT * FROM sevens LIMIT <span class="hljs-number">10</span>;
Choose <span class="hljs-keyword">this</span> option instead.
<span class="hljs-number">7</span>
<span class="hljs-number">7</span>
<span class="hljs-number">7</span>
<span class="hljs-number">7</span>
Choose <span class="hljs-keyword">this</span> option instead.
Choose <span class="hljs-keyword">this</span> option instead.
<span class="hljs-number">7</span>
<span class="hljs-number">7</span>
<span class="hljs-number">7</span></code></pre>



<pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> sevens <span class="hljs-keyword">AS</span>
<div class="alt solution-4">  <span class="hljs-keyword">SELECT</span> <span class="hljs-string">"REPLACE THIS LINE WITH YOUR SOLUTION"</span>;
</div><div class="solution solution-4">  <span class="hljs-keyword">SELECT</span> s.seven <span class="hljs-keyword">FROM</span> students <span class="hljs-keyword">AS</span> s, checkboxes <span class="hljs-keyword">AS</span> c <span class="hljs-keyword">WHERE</span> s.number = <span class="hljs-number">7</span> <span class="hljs-keyword">AND</span> c.<span class="hljs-string">'7'</span> = <span class="hljs-string">'True'</span> <span class="hljs-keyword">AND</span> s.time = c.time;</div></code></pre>


        <button id="solution-4" class="btn btn-outline btn-lg toggle solution" style="display: inline-block;">
        Toggle Solution<noscript> (enable JavaScript)</noscript>
        </button>
        

<p>Use Ok to test your code:</p><pre><code class="nohighlight">python3 ok -q sevens</code></pre>
<h3 class="question" id="q6">Q6: Matchmaker, Matchmaker</h3>

<p>Did you take 61A with the hope of finding your soul mate? Well you're in luck!
With all this data in hand, it's easy for us to find your perfect match. If two
students want the same pet and have the same taste in music, they are clearly meant
to be together! In order to provide some more information for the potential lovebirds
to converse about, let's include the favorite colors of the two individuals as well!</p>

<p>In order to match up students, you will have to do a join on the <code>students</code> table
with itself. When you do a join, SQLite will match every single row with every single
other row, so make sure you do not match anyone with themselves, or match any given pair
twice!</p>

<blockquote><p><strong>Important Note:</strong> When pairing the first and second person, make sure that
the first person responded first (i.e. they have an earlier <code>time</code>). This is
to ensure your output matches our tests.</p>

<p><em>Hint:</em> Remember you only want a pair of students to appear once. Refer back
to the football example on how that was done.</p></blockquote>

<p>Write a SQL query to create a table that has 4 columns:</p>

<ul>
  <li>The shared preferred <code>pet</code> of the couple</li>
  <li>The shared favorite <code>song</code> of the couple</li>
  <li>The favorite <code>color</code> of the first person</li>
  <li>The favorite <code>color</code> of the second person</li>
</ul>

<p>You should get the following output:</p>

<pre><code class="hljs ruby">sqlite&gt; SELECT * FROM matchmaker LIMIT <span class="hljs-number">10</span>;
panda<span class="hljs-params">|Havana|</span>grey<span class="hljs-params">|blue
panda|</span>Havana<span class="hljs-params">|grey|</span>blue
wolf<span class="hljs-params">|Despacito|</span>black<span class="hljs-params">|blue
wolf|</span>Despacito<span class="hljs-params">|black|</span>purple
wolf<span class="hljs-params">|Despacito|</span>black<span class="hljs-params">|silver
cat|</span>Nyan Cat<span class="hljs-params">|orange|</span>blue
cat<span class="hljs-params">|Nyan Cat|</span>orange<span class="hljs-params">|red
cat|</span>Nyan Cat<span class="hljs-params">|orange|</span>cobalt
cat<span class="hljs-params">|Nyan Cat|</span>orange<span class="hljs-params">|orange
cat|</span>Nyan Cat<span class="hljs-params">|orange|</span>blue</code></pre>



<pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> matchmaker <span class="hljs-keyword">AS</span>
<div class="alt solution-5">  <span class="hljs-keyword">SELECT</span> <span class="hljs-string">"REPLACE THIS LINE WITH YOUR SOLUTION"</span>;
</div><div class="solution solution-5">  <span class="hljs-keyword">SELECT</span> a.pet, a.song, a.color, b.color <span class="hljs-keyword">FROM</span> students <span class="hljs-keyword">AS</span> a, students <span class="hljs-keyword">AS</span> b
    <span class="hljs-keyword">WHERE</span> a.time &lt; b.time <span class="hljs-keyword">AND</span> a.pet = b.pet <span class="hljs-keyword">AND</span> a.song = b.song;</div></code></pre>


        <button id="solution-5" class="btn btn-outline btn-lg toggle solution" style="display: inline-block;">
        Toggle Solution<noscript> (enable JavaScript)</noscript>
        </button>
        

<p>Use Ok to test your code:</p><pre><code class="nohighlight">python3 ok -q matchmaker</code></pre>


<h2 id="extra-questions">Extra Questions</h2>


<p>The following questions are for <strong>extra practice</strong> -- they can be found
in the <a href="https://cs61a.org/lab/lab12/lab12_extra.sql">lab12_extra.sql</a> file. It is recommended that
you complete these problems, but you do not need to turn them
in for credit.</p>


<h2 id="the-count-aggregator">The COUNT Aggregator</h2>


<p>How many people liked each pet? What is the biggest date chosen this semester?
How many obedient people chose Image 1 for Professor DeNero or Professor Hilfinger?
Is there a difference between last semester's average favorite number 
and this semester's?</p>

<p>To answer these types of questions, we can bring in SQL aggregation, which
allows us to accumulate values across rows in our SQL database!</p>

<p>In order to perform SQL aggregation, we can group rows in our table by one or more attributes. Once
we have groups, we can aggregate over the groups in our table and find things like:</p>

<ul>
  <li>the maximum value (<code>MAX</code>),</li>
  <li>the minimum value (<code>MIN</code>),</li>
  <li>the number of rows in the group (<code>COUNT</code>),</li>
  <li>the average over all of the values (<code>AVG</code>),</li>
</ul>

<p>and more!
<code>SELECT</code> statements that use aggregation are usually marked by two things: an
aggregate function (<code>MAX</code>, <code>MIN</code>, <code>COUNT</code>, <code>AVG</code>, etc.) and a <code>GROUP BY</code> clause.
<code>GROUP BY [column(s)]</code> groups together rows with the same value in each
column(s).
In this section we will only use <code>COUNT</code>, which will count the number of rows in
each group, but feel free to check out
<a href="http://www.sqlcourse2.com/agg_functions.html">http://www.sqlcourse2.com/agg_functions.html</a>
for more!</p>

<p>For example, the following query will print out the top 10 favorite numbers with
their respective counts:</p>

<pre><code class="hljs ruby">sqlite&gt; SELECT number, COUNT(*) AS count FROM students GROUP BY number
  ORDER BY count DESC LIMIT <span class="hljs-number">10</span>;
  <span class="hljs-number">69</span><span class="hljs-params">|66
  7|</span><span class="hljs-number">44</span>
  <span class="hljs-number">13</span><span class="hljs-params">|23
  17|</span><span class="hljs-number">21</span>
  <span class="hljs-number">2</span><span class="hljs-params">|20
  42|</span><span class="hljs-number">17</span>
  <span class="hljs-number">1</span><span class="hljs-params">|16
  8|</span><span class="hljs-number">15</span>
  <span class="hljs-number">11</span><span class="hljs-params">|15
  5|</span><span class="hljs-number">13</span></code></pre>

<p>This <code>SELECT</code> statement first groups all of the rows in our table <code>students</code> by <code>number</code>. Then, within each
group, we perform aggregation by <code>COUNT</code>ing all the rows. By selecting <code>number</code> and <code>COUNT(*)</code>,
we then can see the highest <code>number</code> and how many students picked that number. We have to order by our <code>COUNT(*)</code>, which is saved in the alias <code>count</code>, by <code>DESC</code>ending order, so our highest count starts at the top, and we limit our result to the top 10.
<br>

</p><h3 class="question" id="q7">Q7: Let's Count</h3>
Let's have some fun with this! For each statement we created a separate table in
<code>lab12_extra.sql</code> so fill in the corresponding table and run it using Ok. Try
working on this on your own or with a neighbor before toggling to see the
solutions.<p></p>

<p>What was the favorite number from last semester?</p>

<pre><code class="hljs shell"><span class="hljs-meta">sqlite&gt;</span><span class="bash"> SELECT * FROM sp17favnum;</span>
7|25</code></pre>



<pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> sp17favnum <span class="hljs-keyword">AS</span>
<div class="alt solution-6">  <span class="hljs-keyword">SELECT</span> <span class="hljs-string">"REPLACE THIS LINE WITH YOUR SOLUTION"</span>;
</div><div class="solution solution-6">  <span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">number</span>, <span class="hljs-keyword">COUNT</span>(*) <span class="hljs-keyword">AS</span> <span class="hljs-keyword">count</span> <span class="hljs-keyword">FROM</span> sp17students
    <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> <span class="hljs-built_in">number</span> <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> <span class="hljs-keyword">count</span> <span class="hljs-keyword">DESC</span> <span class="hljs-keyword">LIMIT</span> <span class="hljs-number">1</span>;</div></code></pre>


        <button id="solution-6" class="btn btn-outline btn-lg toggle solution" style="display: inline-block;">
        Toggle Solution<noscript> (enable JavaScript)</noscript>
        </button>
        

<p>What were the top 10 pets last semester?</p>

<pre><code class="hljs ruby">sqlite&gt; SELECT * FROM sp17favpets;
dragon<span class="hljs-params">|20
dog|</span><span class="hljs-number">14</span>
cat<span class="hljs-params">|8
unicorn|</span><span class="hljs-number">7</span>
n/a<span class="hljs-params">|6
panda|</span><span class="hljs-number">5</span>
dolphin<span class="hljs-params">|4
tiger|</span><span class="hljs-number">4</span>
<span class="hljs-number">7</span><span class="hljs-params">|3
bear|</span><span class="hljs-number">3</span></code></pre>



<pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> sp17favpets <span class="hljs-keyword">AS</span>
<div class="alt solution-7">  <span class="hljs-keyword">SELECT</span> <span class="hljs-string">"REPLACE THIS LINE WITH YOUR SOLUTION"</span>;
</div><div class="solution solution-7">  <span class="hljs-keyword">SELECT</span> pet, <span class="hljs-keyword">COUNT</span>(*) <span class="hljs-keyword">AS</span> <span class="hljs-keyword">count</span> <span class="hljs-keyword">FROM</span> sp17students
    <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> pet <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> <span class="hljs-keyword">count</span> <span class="hljs-keyword">DESC</span> <span class="hljs-keyword">LIMIT</span> <span class="hljs-number">10</span>;</div></code></pre>


        <button id="solution-7" class="btn btn-outline btn-lg toggle solution" style="display: inline-block;">
        Toggle Solution<noscript> (enable JavaScript)</noscript>
        </button>
        

<p>What are the top 10 pets this semester?</p>

<pre><code class="hljs ruby">sqlite&gt; SELECT * FROM fa17favpets;
dog<span class="hljs-params">|57
cat|</span><span class="hljs-number">33</span>
dragon<span class="hljs-params">|14
panda|</span><span class="hljs-number">14</span>
tiger<span class="hljs-params">|14
lion|</span><span class="hljs-number">13</span>
penguin<span class="hljs-params">|12
dolphin|</span><span class="hljs-number">10</span>
john denero<span class="hljs-params">|9
elephant|</span><span class="hljs-number">8</span></code></pre>



<pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> fa17favpets <span class="hljs-keyword">AS</span>
<div class="alt solution-8">  <span class="hljs-keyword">SELECT</span> <span class="hljs-string">"REPLACE THIS LINE WITH YOUR SOLUTION"</span>;
</div><div class="solution solution-8">  <span class="hljs-keyword">SELECT</span> pet, <span class="hljs-keyword">COUNT</span>(*) <span class="hljs-keyword">AS</span> <span class="hljs-keyword">count</span> <span class="hljs-keyword">FROM</span> students
    <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> pet <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> <span class="hljs-keyword">count</span> <span class="hljs-keyword">DESC</span> <span class="hljs-keyword">LIMIT</span> <span class="hljs-number">10</span>;</div></code></pre>


        <button id="solution-8" class="btn btn-outline btn-lg toggle solution" style="display: inline-block;">
        Toggle Solution<noscript> (enable JavaScript)</noscript>
        </button>
        

<p>How many people marked exactly the word 'dog' as their ideal pet this semester?</p>

<pre><code class="hljs shell"><span class="hljs-meta">sqlite&gt;</span><span class="bash"> SELECT * FROM fa17dog;</span>
dog|57</code></pre>



<pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> fa17dog <span class="hljs-keyword">AS</span>
<div class="alt solution-9">  <span class="hljs-keyword">SELECT</span> <span class="hljs-string">"REPLACE THIS LINE WITH YOUR SOLUTION"</span>;
</div><div class="solution solution-9">  <span class="hljs-keyword">SELECT</span> pet, <span class="hljs-keyword">COUNT</span>(*) <span class="hljs-keyword">FROM</span> students <span class="hljs-keyword">WHERE</span> pet = <span class="hljs-string">'dog'</span>;</div></code></pre>


        <button id="solution-9" class="btn btn-outline btn-lg toggle solution" style="display: inline-block;">
        Toggle Solution<noscript> (enable JavaScript)</noscript>
        </button>
        

<p>Although close, our query doesn't give us an entirely accurate picture of what people's favorite pets are.
For example, <code>a dog</code> would not be counted the same as <code>dog</code>. Let's see how many people actually want
a dog this semester by using <code>LIKE</code>, which compares substrings. We can use it inside <code>WHERE</code>, as in
<code>WHERE [column_name] LIKE '%[word]%'</code> to find how many people would like some type of dog.</p>

<pre><code class="hljs shell"><span class="hljs-meta">sqlite&gt;</span><span class="bash"> SELECT * from fa17alldogs;</span>
dog|84</code></pre>



<pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> fa17alldogs <span class="hljs-keyword">AS</span>
<div class="alt solution-10">  <span class="hljs-keyword">SELECT</span> <span class="hljs-string">"REPLACE THIS LINE WITH YOUR SOLUTION"</span>;
</div><div class="solution solution-10">  <span class="hljs-keyword">SELECT</span> pet, <span class="hljs-keyword">COUNT</span>(*) <span class="hljs-keyword">FROM</span> students <span class="hljs-keyword">WHERE</span> pet <span class="hljs-keyword">LIKE</span> <span class="hljs-string">'%dog%'</span>;</div></code></pre>


        <button id="solution-10" class="btn btn-outline btn-lg toggle solution" style="display: inline-block;">
        Toggle Solution<noscript> (enable JavaScript)</noscript>
        </button>
        

<p>We can find the student's favorite for any column (try it yourself in the
interpreter), but let's go back to our Obedience question. Let's see how many
obedient students this semester picked each image of each professor. 
We can do this by selecting only the rows that have <code>seven = '7'</code> 
then <code>GROUP BY denero, hilfinger</code>, and finally we can
<code>COUNT</code> them.</p>

<pre><code class="hljs ruby">sqlite&gt; SELECT * FROM obedienceimages LIMIT <span class="hljs-number">5</span>;
<span class="hljs-number">7</span><span class="hljs-params">|Image 1|</span>Image <span class="hljs-number">1</span><span class="hljs-params">|7
7|</span>Image <span class="hljs-number">1</span><span class="hljs-params">|Image 2|</span><span class="hljs-number">6</span>
<span class="hljs-number">7</span><span class="hljs-params">|Image 1|</span>Image <span class="hljs-number">3</span><span class="hljs-params">|16
7|</span>Image <span class="hljs-number">1</span><span class="hljs-params">|Image 4|</span><span class="hljs-number">14</span>
<span class="hljs-number">7</span><span class="hljs-params">|Image 1|</span>Image <span class="hljs-number">5</span><span class="hljs-params">|11</span></code></pre>



<pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> obedienceimages <span class="hljs-keyword">AS</span>
<div class="alt solution-11">  <span class="hljs-keyword">SELECT</span> <span class="hljs-string">"REPLACE THIS LINE WITH YOUR SOLUTION"</span>;
</div><div class="solution solution-11">  <span class="hljs-keyword">SELECT</span> seven, denero, hilfinger, <span class="hljs-keyword">COUNT</span>(*) <span class="hljs-keyword">FROM</span> students <span class="hljs-keyword">WHERE</span> seven = <span class="hljs-string">'7'</span>
    <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> denero, hilfinger;</div></code></pre>


        <button id="solution-11" class="btn btn-outline btn-lg toggle solution" style="display: inline-block;">
        Toggle Solution<noscript> (enable JavaScript)</noscript>
        </button>
        

<p>The possibilities are endless, so have fun experimenting!</p>

<p>Use Ok to test your code:</p><pre><code class="nohighlight">python3 ok -q lets-count</code></pre>

<h3 class="question" id="q8">Q8: The Smallest Unique Positive Integer (Part 2)</h3>

<p>Now, let's revisit the previous problem of finding the smallest positive integer that anyone chose, and take
a closer look at the <code>COUNT</code> aggregate.</p>

<p>Write a SQL query that uses the <code>COUNT</code> aggregate to create a table that pairs the attribute <code>smallest</code> with
the number of times it was chosen by a student (this is the aggregation part).</p>

<blockquote><p><em>Hint:</em> You may find that there isn't a particular attribute you should have to perform the <code>COUNT</code>
aggregation over. If you are only interested in counting the number of rows in a group, you can just
say <code>COUNT(*)</code>.</p>

<p><em>Hint:</em> Think about what attribute you need to <code>GROUP BY</code>.</p></blockquote>

<p>After you've defined your table, you should get something like:</p>

<pre><code class="hljs ruby">sqlite&gt; SELECT * FROM smallest_int_count LIMIT <span class="hljs-number">25</span>;
<span class="hljs-number">0</span><span class="hljs-params">|1
0.01|</span><span class="hljs-number">1</span>
<span class="hljs-number">1</span><span class="hljs-params">|163
2|</span><span class="hljs-number">15</span>
<span class="hljs-number">3</span><span class="hljs-params">|13
4|</span><span class="hljs-number">15</span>
<span class="hljs-number">5</span><span class="hljs-params">|4
6|</span><span class="hljs-number">11</span>
<span class="hljs-number">7</span><span class="hljs-params">|13
8|</span><span class="hljs-number">11</span>
<span class="hljs-number">9</span><span class="hljs-params">|6
10|</span><span class="hljs-number">4</span>
<span class="hljs-number">11</span><span class="hljs-params">|14
12|</span><span class="hljs-number">13</span>
<span class="hljs-number">13</span><span class="hljs-params">|8
14|</span><span class="hljs-number">13</span>
<span class="hljs-number">15</span><span class="hljs-params">|4
16|</span><span class="hljs-number">3</span>
<span class="hljs-number">17</span><span class="hljs-params">|21
18|</span><span class="hljs-number">5</span>
<span class="hljs-number">19</span><span class="hljs-params">|9
20|</span><span class="hljs-number">1</span>
<span class="hljs-number">21</span><span class="hljs-params">|2
22|</span><span class="hljs-number">3</span>
<span class="hljs-number">23</span><span class="hljs-params">|24</span></code></pre>



<pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> smallest_int_count <span class="hljs-keyword">AS</span>
<div class="alt solution-12">  <span class="hljs-keyword">SELECT</span> <span class="hljs-string">"REPLACE THIS LINE WITH YOUR SOLUTION"</span>;
</div><div class="solution solution-12">  <span class="hljs-keyword">SELECT</span> smallest, <span class="hljs-keyword">COUNT</span>(*) <span class="hljs-keyword">FROM</span> students <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> smallest;</div></code></pre>


        <button id="solution-12" class="btn btn-outline btn-lg toggle solution" style="display: inline-block;">
        Toggle Solution<noscript> (enable JavaScript)</noscript>
        </button>
        

<p>Use Ok to test your code:</p><pre><code class="nohighlight">python3 ok -q smallest-int-count</code></pre>

<p>It looks like the number <code>20</code> only had one person choose it! Were you the lucky student that put
it down?</p>

  </div>

  <div class="col-md-3 sticky">
    <nav class="hidden-print hidden-sm hidden-xs sidebar">
      <ul class="nav nav-stacked noselect">
  <li><a href="https://cs61a.org/lab/lab12/#setup">Setup</a></li>
  <ul class="nav nav-stacked noselect">
    <li><a href="https://cs61a.org/lab/lab12/#windows">Windows</a></li>
    <li><a href="https://cs61a.org/lab/lab12/#macos-yosemite-10-10-el-capitan-10-11-sierra-10-12">macOS Yosemite (10.10), El Capitan (10.11), Sierra (10.12)</a></li>
    <li><a href="https://cs61a.org/lab/lab12/#mac-os-x-mavericks-10-9-or-older">Mac OS X Mavericks (10.9) or older</a></li>
    <li><a href="https://cs61a.org/lab/lab12/#ubuntu">Ubuntu</a></li>
  </ul>
  <li><a href="https://cs61a.org/lab/lab12/#usage">Usage</a></li>
  <li><a href="https://cs61a.org/lab/lab12/#sql-basics">SQL Basics</a></li>
  <ul class="nav nav-stacked noselect">
    <li><a href="https://cs61a.org/lab/lab12/#creating-tables">Creating Tables</a></li>
    <li><a href="https://cs61a.org/lab/lab12/#selecting-from-tables">Selecting From Tables</a></li>
    <li><a href="https://cs61a.org/lab/lab12/#expressions-in-sql">Expressions in SQL</a></li>
  </ul>
  <li><a href="https://cs61a.org/lab/lab12/#getting-to-know-your-fellow-61a-students">Getting to Know Your Fellow 61A Students</a></li>
  <ul class="nav nav-stacked noselect">
    <li><a href="https://cs61a.org/lab/lab12/#q1">Q1: What Would SQL print?</a></li>
    <li><a href="https://cs61a.org/lab/lab12/#q2">Q2: Obedience</a></li>
    <li><a href="https://cs61a.org/lab/lab12/#q3">Q3: The Smallest Unique Positive Integer</a></li>
  </ul>
  <li><a href="https://cs61a.org/lab/lab12/#joins">Joins</a></li>
  <ul class="nav nav-stacked noselect">
    <li><a href="https://cs61a.org/lab/lab12/#q4">Q4: Great Students Think Alike</a></li>
    <li><a href="https://cs61a.org/lab/lab12/#q5">Q5: Sevens</a></li>
    <li><a href="https://cs61a.org/lab/lab12/#q6">Q6: Matchmaker, Matchmaker</a></li>
  </ul>
  <li><a href="https://cs61a.org/lab/lab12/#extra-questions">Extra Questions</a></li>
  <li><a href="https://cs61a.org/lab/lab12/#the-count-aggregator">The COUNT Aggregator</a></li>
  <ul class="nav nav-stacked noselect">
    <li><a href="https://cs61a.org/lab/lab12/#q7">Q7: Let's Count</a></li>
    <li><a href="https://cs61a.org/lab/lab12/#q8">Q8: The Smallest Unique Positive Integer (Part 2)</a></li>
  </ul>
</ul>
    </nav>
  </div>
</div>

    </main>

    <footer class="container">
      <div class="row text-center">
        <div class="col col-sm-4">
          <h3><a href="https://cs61a.org/">CS 61A</a></h3>
          <ul class="nav nav-pills nav-stacked">
            <li><a href="https://cs61a.org/weekly.html">Weekly Schedule</a></li>
            <li><a href="https://cs61a.org/office-hours.html">Office Hours</a></li>
            <li><a href="https://cs61a.org/staff.html">Staff</a></li>
          </ul>
        </div>
        <div class="col col-sm-4">
          <h3><a href="https://cs61a.org/resources.html">Resources</a></h3>
          <ul class="nav nav-pills nav-stacked">
            <li><a href="https://cs61a.org/articles/studying.html">Studying Guide</a></li>
            <li><a href="https://cs61a.org/articles/debugging.html">Debugging Guide</a></li>
            <li><a href="https://cs61a.org/articles/composition.html">Composition Guide</a></li>
          </ul>
        </div>
        <div class="col col-sm-4">
          <h3><a href="https://cs61a.org/articles/about.html">Policies</a></h3>
          <ul class="nav nav-pills nav-stacked">
            <li><a href="https://cs61a.org/articles/about.html#assignments">Assignments</a></li>
            <li><a href="https://cs61a.org/articles/about.html#exams">Exams</a></li>
            <li><a href="https://cs61a.org/articles/about.html#grading">Grading</a></li>
          </ul>
        </div>
      </div>
    </footer>

    


<script>
  $('.sidebar ul').addClass('nav nav-stacked noselect');
  $('body').scrollspy({
    target: '.sidebar',
    offset: 40
  });
</script>


<script>
  $(function() {
    var staging_domains = ['staging.cs61a.org', 'localhost', '127.0.0.1'];

    var staging = staging_domains.indexOf(window.location.hostname) != -1;
    var after_due_date = new Date("11/18/2017") < new Date();
    var release_solutions = staging || after_due_date;

    if (release_solutions) {
      $('.toggle').css('display', 'inline-block');
      $('.toggle').click(function() {
        var solution_id = $(this).attr('id');
        $('div.' + solution_id).slideToggle(600);
      });
    }
  });
</script>


  
</body></html>